<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='icon.png') }}">

    <!-- –®—Ä–∏—Ñ—Ç –∏ –∏–∫–æ–Ω–∫–∏ -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/your-kit-id.js" crossorigin="anonymous"></script>

    <style>
      body {
        font-family: 'Inter', sans-serif;
        background: linear-gradient(135deg, #6a11cb, #2575fc);
        color: white;
        padding: 40px;
      }
      header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
      }
      header img {
        height: 50px;
      }
      header h1 {
        margin: 0;
        font-size: 28px;
        font-weight: 600;
      }
      .menu {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 30px;
      }
      .menu a button {
        background: rgba(255,255,255,0.1);
        border: none;
        padding: 15px 25px;
        border-radius: 12px;
        font-size: 18px;
        color: white;
        cursor: pointer;
        transition: 0.3s;
      }
      .menu a button:hover {
        background: rgba(255,255,255,0.3);
      }
      .box {
        border:1px solid rgba(255,255,255,0.3);
        padding:10px;
        border-radius: 8px;
        background: rgba(0,0,0,0.3);
        color:#fff;
        font-family:monospace;
        margin-bottom: 20px;
      }
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <header>
      <img src="{{ url_for('static', filename='icon.png') }}" alt="Logo">
      <h1>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
    </header>

    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
    <h2>üëã –ü—Ä–∏–≤–µ—Ç, {{ user }}</h2>
    <p>üîó –ê–¥—Ä–µ—Å WebSocket: <code>wss://arinairina.duckdns.org/ws/</code></p>

    <!-- –ú–µ–Ω—é -->
    <div class="menu">
      <a href="{{ url_for('qrcode_page') }}"><button><i class="fas fa-qrcode"></i> QR‚Äë–∫–æ–¥</button></a>
      <a href="{{ url_for('stats_page') }}"><button><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button></a>
      <a href="{{ url_for('rules') }}"><button><i class="fas fa-cogs"></i> –ü—Ä–∞–≤–∏–ª–∞</button></a>
      <a href="{{ url_for('logout') }}"><button><i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏</button></a>
    </div>

    <!-- –õ–æ–≥–∏ -->
    <h3>üìú –õ–æ–≥–∏ –¥–æ–Ω–∞—Ç–æ–≤</h3>
    <div id="logbox" class="box" style="height:300px; overflow-y:scroll;"></div>
    <form method="POST" action="/clear_logs">
        <button type="submit">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
    </form>

    <!-- –û—á–µ—Ä–µ–¥—å -->
    <h3>üîÅ –û—á–µ—Ä–µ–¥—å –≤–∏–±—Ä–∞—Ü–∏–π</h3>
    <div id="queuebox" class="box" style="height:200px; overflow-y:scroll;"></div>

    <!-- JS -->
    <script>
      async function loadLogs() {
        const res = await fetch("/logs_data");
        const data = await res.json();
        const box = document.getElementById("logbox");
        box.innerHTML = data.logs.map(l => {
          if (l.includes("üé¨")) {
            return `<div style="color: goldenrod; font-weight: bold;">${l}</div>`;
          }
          return `<div>${l}</div>`;
        }).join("");
        box.scrollTop = box.scrollHeight;
      }

      async function loadQueue() {
        const res = await fetch("/queue_data");
        const data = await res.json();
        const box = document.getElementById("queuebox");
        if (data.queue.length === 0) {
          box.innerHTML = "<div>–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞ ‚úÖ</div>";
        } else {
          box.innerHTML = data.queue.map(([strength, duration], i) => {
            return `<div>#${i + 1} ‚Üí —Å–∏–ª–∞: ${strength}, –≤—Ä–µ–º—è: ${duration}s</div>`;
          }).join("");
        }
      }

      setInterval(loadLogs, 2000);
      setInterval(loadQueue, 2000);
      loadLogs();
      loadQueue();
    </script>
    
</body>
</html>
