<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ</title>
</head>
<body>
    <h1>ğŸ‘‹ ĞŸÑ€Ğ¸Ğ²ĞµÑ‚, {{ user }}</h1>

    <p>ğŸ”— ĞĞ´Ñ€ĞµÑ WebSocket Ğ´Ğ»Ñ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ: 
        <code>wss://arinairina.duckdns.org/ws/</code>
    </p>

    <p><a href="{{ url_for('qrcode_page') }}">ğŸ“± ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ QRâ€‘ĞºĞ¾Ğ´ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ</a></p>
    <a href="{{ url_for('stats_page') }}">
      <button>ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°</button>
    </a>
    <p><a href="{{ url_for('rules') }}">ğŸ“œ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼Ğ¸</a></p>

    <h3>ğŸ“œ Ğ›Ğ¾Ğ³Ğ¸ Ğ´Ğ¾Ğ½Ğ°Ñ‚Ğ¾Ğ²</h3>
    <div id="logbox" style="border:1px solid #ccc; padding:10px; height:300px; overflow-y:scroll; background:#fff; color:#000; font-family:monospace;"></div>
    <form method="POST" action="/clear_logs">
        <button type="submit">ğŸ§¹ ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ»Ğ¾Ğ³</button>
    </form>

    <h3>ğŸ” ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ²Ğ¸Ğ±Ñ€Ğ°Ñ†Ğ¸Ğ¹</h3>
    <div id="queuebox" style="border:1px solid #ccc; padding:10px; height:200px; overflow-y:scroll; background:#f9f9f9; color:#000; font-family:monospace;"></div>

    <script>
      async function loadLogs() {
        const res = await fetch("/logs_data");
        const data = await res.json();
        const box = document.getElementById("logbox");
        box.innerHTML = data.logs.map(l => {
          if (l.includes("ğŸ¬")) {
            return `<div style="color: goldenrod; font-weight: bold;">${l}</div>`;
          }
          return `<div>${l}</div>`;
        }).join("");
        box.scrollTop = box.scrollHeight;
      }

      async function loadQueue() {
        const res = await fetch("/queue_data");
        const data = await res.json();
        const box = document.getElementById("queuebox");
        if (data.queue.length === 0) {
          box.innerHTML = "<div>ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¿ÑƒÑÑ‚Ğ° âœ…</div>";
        } else {
          box.innerHTML = data.queue.map(([strength, duration], i) => {
            return `<div>#${i + 1} â†’ ÑĞ¸Ğ»Ğ°: ${strength}, Ğ²Ñ€ĞµĞ¼Ñ: ${duration}s</div>`;
          }).join("");
        }
      }

      setInterval(loadLogs, 2000);
      setInterval(loadQueue, 2000);
      loadLogs();
      loadQueue();
    </script>

    <p><a href="{{ url_for('logout') }}">ğŸšª Ğ’Ñ‹Ğ¹Ñ‚Ğ¸</a></p>
</body>
</html>
